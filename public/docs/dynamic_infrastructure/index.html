<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Dynamic Infrastructure - Sparta</title>
    <meta name="generator" content="Hugo 0.20.2" />

    
    <meta name="description" content="Sparta - Go framework for AWS Lambda">
    
    <link rel="canonical" href="http://gosparta.io/docs/dynamic_infrastructure/">
    
    <meta name="author" content="Matt Weagle">
    

    <meta property="og:url" content="http://gosparta.io/docs/dynamic_infrastructure/">
    <meta property="og:title" content="Sparta">
    <meta property="og:image" content="http://gosparta.io/images/SpartaHelmet.png">
    <meta name="apple-mobile-web-app-title" content="Sparta">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://gosparta.io/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="http://gosparta.io/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://gosparta.io/fonts/icon.eot');
        src: url('http://gosparta.io/fonts/icon.eot')
               format('embedded-opentype'),
             url('http://gosparta.io/fonts/icon.woff')
               format('woff'),
             url('http://gosparta.io/fonts/icon.ttf')
               format('truetype'),
             url('http://gosparta.io/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://gosparta.io/stylesheets/application.css">
    <link rel="stylesheet" href="http://gosparta.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://gosparta.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://gosparta.io/highlights_js/styles/xcode.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open%20Sans:400,700|Inconsolata">
    <style>
      body, input {
        font-family: 'Open Sans', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Inconsolata', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="http://gosparta.io/mermaid_dist/mermaid.forest.css">
    
    <link rel="stylesheet" href="http://gosparta.io/font-awesome-4.7.0/css/font-awesome.min.css">
    
    <script src="http://gosparta.io/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-grey palette-accent-blue">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Dynamic Infrastructure
      </div>
    </div>

    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/mweagle" title="@mweagle on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/mweagle" title="@mweagle on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/mweagle/Sparta" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://gosparta.io/images/SpartaHelmet.png">
        </div>
      
      <div class="name">
        <strong>Sparta <span class="version">0.11.1</span></strong>
        
          <br>
          mweagle/Sparta
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/mweagle/Sparta/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/mweagle/Sparta/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Sparta" href="http://gosparta.io/">
	
	Sparta
</a>



  
</li>



<li>
  
    



<a  title="Overview" href="http://gosparta.io/docs/overview">
	
	Overview
</a>



  
</li>



<li>
  
    



<a  title="Sample Service" href="http://gosparta.io/docs/intro_example/intro">
	
	Sample Service
</a>



  
</li>



<li>
  
    <span class="section">Documentation</span>
    <ul>
      
        
        



<a  title="Sample Service" href="http://gosparta.io/docs/intro_example/intro/">
	
	Sample Service
</a>



      
        
        



<a  title="API Gateway" href="http://gosparta.io/docs/apigateway/apigateway/">
	
	API Gateway
</a>



      
        
        



<a  title="Alternative Topologies" href="http://gosparta.io/docs/alternative_topologies/">
	
	Alternative Topologies
</a>



      
        
        



<a  title="Application Customization" href="http://gosparta.io/docs/application/application/">
	
	Application Customization
</a>



      
        
        



<a  title="CGO" href="http://gosparta.io/docs/cgo/">
	
	CGO
</a>



      
        
        



<a  title="Custom Resources" href="http://gosparta.io/docs/custom_resources/">
	
	Custom Resources
</a>



      
        
        



<a  title="Discovery Service" href="http://gosparta.io/docs/discovery/">
	
	Discovery Service
</a>



      
        
        



<a  title="Docker" href="http://gosparta.io/docs/docker/">
	
	Docker
</a>



      
        
        



<a class="current" title="Dynamic Infrastructure" href="http://gosparta.io/docs/dynamic_infrastructure/">
	
	Dynamic Infrastructure
</a>


<ul id="scrollspy">
</ul>


      
        
        



<a  title="Event Sources" href="http://gosparta.io/docs/eventsources/eventsources/">
	
	Event Sources
</a>



      
        
        



<a  title="Limitations" href="http://gosparta.io/docs/limitations/">
	
	Limitations
</a>



      
        
        



<a  title="Local Testing" href="http://gosparta.io/docs/local_testing/">
	
	Local Testing
</a>



      
        
        



<a  title="S3 Sites with CORS" href="http://gosparta.io/docs/s3site/">
	
	S3 Sites with CORS
</a>



      
    </ul>
  
</li>



<li>
  
    



<a  title="FAQ" href="http://gosparta.io/docs/faq">
	
	FAQ
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          
          <li>
            <a href="https://twitter.com/mweagle" target="_blank" title="@mweagle on Twitter">
              @mweagle on Twitter
            </a>
          </li>
          

          
          <li>
            <a href="https://github.com/mweagle" target="_blank" title="@mweagle on GitHub">
              @mweagle on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:mweagle@gmail.com" title="Email of mweagle@gmail.com">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Dynamic Infrastructure </h1>

			

<h1 id="introduction">Introduction</h1>

<p>In addition to provisioning AWS Lambda functions, Sparta supports the creation of other <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html">CloudFormation Resources</a>.  This enables a service to move towards <a href="https://fugue.co/oreilly/">immutable infrastructure</a>, where the service and its infrastructure requirements are treated as a logical unit.</p>

<p>For instance, consider the case where two developers are working in the same AWS account.</p>

<ul>
<li>Developer 1 is working on analyzing text documents.

<ul>
<li>Their lambda code is triggered in response to uploading sample text documents to S3.</li>
</ul></li>
<li>Developer 2 is working on image recognition.

<ul>
<li>Their lambda code is triggered in response to uploading sample images to S3.</li>
</ul></li>
</ul>

<div class="mermaid">
    
graph LR
  sharedBucket[S3 Bucket]

  dev1Lambda[Dev1 LambdaCode]
  dev2Lambda[Dev2 LambdaCode]

  sharedBucket --> dev1Lambda
  sharedBucket --> dev2Lambda

</div>
<i><small>This diagram is rendered with <a href="https://github.com/knsv/mermaid" target="_blank">Mermaid</a>.
  Please open an <a href="https://github.com/mweagle/Sparta/issues/new" target="_blank">issue</a>
  if it doesn't render properly.</small></i>
<hr />


<p>Using a shared, externally provisioned S3 bucket has several impacts:</p>

<ul>
<li>Adding conditionals in each lambda codebase to scope valid processing targets.</li>
<li>Ambiguity regarding which codebase handled an event.</li>
<li>Infrastructure ownership/lifespan management.  When a service is decommissioned, its infrastructure requirements may be automatically decommissioned as well.

<ul>
<li>Eg, &ldquo;Is this S3 bucket in use by any service?&rdquo;.</li>
</ul></li>
<li>Overly permissive IAM roles due to static Arns.

<ul>
<li>Eg, &ldquo;Arn hugging&rdquo;.</li>
</ul></li>
<li>Contention updating the shared bucket&rsquo;s <a href="http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html#putBucketNotificationConfiguration-property">notification configuration</a>.</li>
</ul>

<p>Alternatively, each developer could provision and manage disjoint topologies:</p>

<div class="mermaid">
    
graph LR
  dev1S3Bucket[Dev1 S3 Bucket]
  dev1Lambda[Dev1 LambdaCode]

  dev2S3Bucket[Dev2 S3 Bucket]
  dev2Lambda[Dev2 LambdaCode]

  dev1S3Bucket --> dev1Lambda
  dev2S3Bucket --> dev2Lambda

</div>
<i><small>This diagram is rendered with <a href="https://github.com/knsv/mermaid" target="_blank">Mermaid</a>.
  Please open an <a href="https://github.com/mweagle/Sparta/issues/new" target="_blank">issue</a>
  if it doesn't render properly.</small></i>
<hr />


<p>Enabling each developer to create other AWS resources also means more complex topologies can be expressed.  These topologies can benefit from CloudWatch monitoring (eg, <a href="http://docs.aws.amazon.com/lambda/latest/dg/monitoring-functions-metrics.html">per-Lambda Metrics</a> ) without the need to add <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/publishingMetrics.html">custom metrics</a>.</p>

<div class="mermaid">
    
graph LR
  dev1S3Bucket[Dev1 S3 Bucket]
  dev1Lambda[Dev1 LambdaCode]

  dev2S3Bucket[Dev2 S3 Images Bucket]
  dev2PNGLambda[Dev2 PNG LambdaCode]
  dev2JPGLambda[Dev2 JPEG LambdaCode]
  dev2TIFFLambda[Dev2 TIFF LambdaCode]
  dev2S3VideoBucket[Dev2 VideoBucket]
  dev2VideoLambda[Dev2 Video LambdaCode]

  dev1S3Bucket --> dev1Lambda
  dev2S3Bucket -->|SuffixFilter=*.PNG|dev2PNGLambda
  dev2S3Bucket -->|SuffixFilter=*.JPEG,*.JPG|dev2JPGLambda
  dev2S3Bucket -->|SuffixFilter=*.TIFF|dev2TIFFLambda
  dev2S3VideoBucket -->dev2VideoLambda

</div>
<i><small>This diagram is rendered with <a href="https://github.com/knsv/mermaid" target="_blank">Mermaid</a>.
  Please open an <a href="https://github.com/mweagle/Sparta/issues/new" target="_blank">issue</a>
  if it doesn't render properly.</small></i>
<hr />


<p>Sparta supports Dynamic Resources via <a href="https://godoc.org/github.com/mweagle/Sparta#TemplateDecorator">TemplateDecorator</a> functions.</p>

<h1 id="template-decorators">Template Decorators</h1>

<p>A template decorator is a <strong>Go</strong> function with the following signature</p>

<pre><code class="language-go">type TemplateDecorator func(serviceName string,
	lambdaResourceName string,
	lambdaResource gocf.LambdaFunction,
	resourceMetadata map[string]interface{},
	S3Bucket string,
	S3Key string,
	buildID string,
	cfTemplate *gocf.Template,
	context map[string]interface{},
	logger *logrus.Logger)  error {

}
</code></pre>

<p>Clients use <a href="https://godoc.org/github.com/crewjam/go-cloudformation">go-cloudformation</a> types for CloudFormation resources and  <code>template.AddResource</code> to add them to the <code>*template</code> parameter.  After a decorator is invoked, Sparta verifies that the user-supplied function has not produced entities that collide with the internally-generated ones.</p>

<h2 id="unique-resource-names">Unique Resource Names</h2>

<p>CloudFormation uses <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resources-section-structure.html">Logical IDs</a> as resource key names.</p>

<p>To minimize collision likelihood, Sparta publishes <a href="https://godoc.org/github.com/mweagle/Sparta#CloudFormationResourceName">CloudFormationResourceName(prefix, &hellip;parts)</a> to generate compliant identifiers.  To produce content-based hash values, callers can provide a non-empty set of values as the <code>...parts</code> variadic argument.  This produces stable identifiers across Sparta execution (which may affect availability during updates).</p>

<p>When called with only a single value (eg: <code>CloudFormationResourceName(&quot;myResource&quot;)</code>), Sparta will return a random resource name that is <strong>NOT</strong> stable across executions.</p>

<h1 id="example-s3-bucket">Example - S3 Bucket</h1>

<p>Let&rsquo;s work through an example to make things a bit more concrete.  We have the following requirements:</p>

<ul>
<li>Our lambda function needs a immutable-infrastructure compliant S3 bucket</li>
<li>Our lambda function should be notified when items are created or deleted from the bucket</li>
<li>Our lambda function must be able to access the contents in the bucket (not shown below)</li>
</ul>

<h2 id="lambda-function">Lambda Function</h2>

<p>To start with, we&rsquo;ll need a Sparta lambda function to expose:</p>

<pre><code class="language-go">func echoS3DynamicBucketEvent(event *json.RawMessage,
  context *sparta.LambdaContext,
  w http.ResponseWriter,
  logger *logrus.Logger) {

  config, _ := sparta.Discover()
  logger.WithFields(logrus.Fields{
    &quot;RequestID&quot;:     context.AWSRequestID,
    &quot;Event&quot;:         string(*event),
    &quot;Configuration&quot;: config,
  }).Info(&quot;Request received&quot;)

  fmt.Fprintf(w, string(*event))
}
</code></pre>

<p>For brevity our demo function doesn&rsquo;t access the S3 bucket objects.  To support that we&rsquo;ll need to discuss the <code>sparta.Discover</code> function in another <a href="http://gosparta.io/docs/discovery/">section</a>.</p>

<h2 id="s3-resource-name">S3 Resource Name</h2>

<p>The next thing we need is a <em>Logical ID</em> for our bucket:</p>

<pre><code class="language-go">s3BucketResourceName := sparta.CloudFormationResourceName(&quot;S3DynamicBucket&quot;, &quot;myServiceBucket&quot;)
</code></pre>

<h2 id="sparta-integration">Sparta Integration</h2>

<p>With these two values we&rsquo;re ready to get started building up the lambda function:</p>

<pre><code class="language-go">lambdaFn := sparta.NewLambda(sparta.IAMRoleDefinition{}, echoS3DynamicBucketEvent, nil)
</code></pre>

<p>The open issue is how to publish the CloudFormation-defined S3 Arn to the <code>compile</code>-time application.  Our lambda function needs to provide both:</p>

<ul>
<li><a href="https://godoc.org/github.com/mweagle/Sparta#IAMRolePrivilege">IAMRolePrivilege</a> values that reference the (as yet) undefined Arn.</li>
<li><a href="https://godoc.org/github.com/mweagle/Sparta#S3Permission">S3Permission</a> values to configure our lambda&rsquo;s event triggers on the (as yet) undefined Arn.</li>
</ul>

<p>The missing piece is <a href="https://godoc.org/github.com/crewjam/go-cloudformation#Ref">gocf.Ref()</a>, whose single argument is the <em>Logical ID</em> of the S3 resource we&rsquo;ll be inserting in the decorator call.</p>

<h3 id="dynamic-iam-role-privilege">Dynamic IAM Role Privilege</h3>

<p>The <code>IAMRolePrivilege</code> struct references the dynamically assigned S3 Arn as follows:</p>

<pre><code class="language-go">lambdaFn.Permissions = append(lambdaFn.Permissions, sparta.S3Permission{
  BasePermission: sparta.BasePermission{
    SourceArn: gocf.Ref(s3BucketResourceName),
  },
  Events: []string{&quot;s3:ObjectCreated:*&quot;, &quot;s3:ObjectRemoved:*&quot;},
})
lambdaFn.DependsOn = append(lambdaFn.DependsOn, s3BucketResourceName)
</code></pre>

<h3 id="dynamic-s3-permissions">Dynamic S3 Permissions</h3>

<p>The <code>S3Permission</code> struct also requires the dynamic Arn, to which it will append <code>&quot;/*&quot;</code> to enable object read access.</p>

<pre><code class="language-go">lambdaFn.RoleDefinition.Privileges = append(lambdaFn.RoleDefinition.Privileges,
  sparta.IAMRolePrivilege{
    Actions:  []string{&quot;s3:GetObject&quot;, &quot;s3:HeadObject&quot;},
    Resource: spartaCF.S3AllKeysArnForBucket(gocf.Ref(s3BucketResourceName)),
  })
</code></pre>

<p>The <code>spartaCF.S3AllKeysArnForBucket</code> call is a convenience wrapper around <a href="https://godoc.org/github.com/crewjam/go-cloudformation#Join">gocf.Join</a> to generate the concatenated, dynamic Arn expression.</p>

<h2 id="s3-resource-insertion">S3 Resource Insertion</h2>

<p>All that&rsquo;s left to do is actually insert the S3 resource in our decorator:</p>

<pre><code class="language-go">lambdaFn.Decorator = func(lambdaResourceName string,
                          lambdaResource gocf.LambdaFunction,
                          template *gocf.Template,
                          logger *logrus.Logger) error {

  cfResource := template.AddResource(s3BucketResourceName, &amp;gocf.S3Bucket{
    AccessControl: gocf.String(&quot;PublicRead&quot;),
  })
  cfResource.DeletionPolicy = &quot;Delete&quot;
  return nil
}
</code></pre>

<h3 id="dependencies">Dependencies</h3>

<p>In reality, we shouldn&rsquo;t even attempt to create the AWS Lambda function if the S3 bucket creation fails.  As application developers, we can help CloudFormation sequence infrastructure operations by stating this hard dependency on the S3 bucket via the <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-dependson.html">DependsOn</a> attribute:</p>

<pre><code class="language-go">lambdaFn.DependsOn = append(lambdaFn.DependsOn, s3BucketResourceName)
</code></pre>

<h2 id="code-listing">Code Listing</h2>

<p>Putting everything together, our Sparta lambda function with dynamic infrastructure is listed below.</p>

<pre><code class="language-go">s3BucketResourceName := sparta.CloudFormationResourceName(&quot;S3DynamicBucket&quot;)

lambdaFn := sparta.NewLambda(sparta.IAMRoleDefinition{}, echoS3DynamicBucketEvent, nil)

// Our lambda function requires the S3 bucket
lambdaFn.DependsOn = append(lambdaFn.DependsOn, s3BucketResourceName)

// Add a permission s.t. the lambda function could read from the S3 bucket
lambdaFn.RoleDefinition.Privileges = append(lambdaFn.RoleDefinition.Privileges,
  sparta.IAMRolePrivilege{
    Actions:  []string{&quot;s3:GetObject&quot;,
                       &quot;s3:HeadObject&quot;},
    Resource: spartaCF.S3AllKeysArnForBucket(gocf.Ref(s3BucketResourceName)),
  })

// Configure the S3 event source
lambdaFn.Permissions = append(lambdaFn.Permissions, sparta.S3Permission{
  BasePermission: sparta.BasePermission{
    SourceArn: gocf.Ref(s3BucketResourceName),
  },
  Events: []string{&quot;s3:ObjectCreated:*&quot;,
                   &quot;s3:ObjectRemoved:*&quot;},
})

// Actually add the resource
lambdaFn.Decorator = func(lambdaResourceName string,
                          lambdaResource gocf.LambdaFunction,
                          template *gocf.Template,
                          logger *logrus.Logger) error {
  cfResource := template.AddResource(s3BucketResourceName, &amp;gocf.S3Bucket{
    AccessControl: gocf.String(&quot;PublicRead&quot;),
  })
  cfResource.DeletionPolicy = &quot;Delete&quot;
  return nil
}
</code></pre>

<h2 id="wrapping-up">Wrapping Up</h2>

<p>Sparta provides an opportunity to bring infrastructure management into the application programming model.  It&rsquo;s still possible to use literal Arn strings, but the ability to include other infrastructure requirements brings a service closer to being self-contained and more operationally sustainable.</p>

<h1 id="notes">Notes</h1>

<ul>
<li>The <code>echoS3DynamicBucketEvent</code> function can also access the bucket Arn via <a href="http://gosparta.io/docs/discovery">sparta.Discover</a>.</li>
<li>See the <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-attribute-deletionpolicy.html">DeletionPolicy</a> documentation regarding S3 management.</li>
<li>CloudFormation resources also publish <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-getatt.html">other outputs</a> that can be retrieved via <a href="https://godoc.org/github.com/crewjam/go-cloudformation#GetAtt">gocf.GetAtt</a>.</li>
<li><code>go-cloudformation</code> exposes <a href="https://godoc.org/github.com/crewjam/go-cloudformation#Join">gocf.Join</a> to create compound, dynamic expressions.

<ul>
<li>See the CloudWatch docs on <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-join.html">Fn::Join</a> for more information.</li>
</ul></li>
</ul>


			<aside class="copyright" role="note">
				
				&copy; 2017 Copyright 2015-2017 Matt Weagle &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://gosparta.io/docs/docker/" title="Docker">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Docker
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://gosparta.io/docs/eventsources/cloudformation/" title="Event Source - CloudFormation">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Event Source - CloudFormation
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>


    <script>
    
      var base_url = 'http:\/\/gosparta.io\/';
      var repo_id  = 'mweagle\/Sparta';
    
    </script>

    <script src="http://gosparta.io/javascripts/application.js"></script>
    
    <script src="http://gosparta.io/mermaid_dist/mermaid.min.js"></script>
    
    <script src="http://gosparta.io/jquery/jquery-2.2.0.min.js"></script>
    

    
    <script>mermaid.initialize({startOnLoad:true});</script>


    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-70794971-1', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

