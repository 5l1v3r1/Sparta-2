<div class="mermaid">
graph TD
  iam[Verify Static IAM Roles]
  preBuild[WorkflowHook - PreBuild]
  style preBuild fill:#61B6EB,stroke:#000,stroke-width:4px;

  compile[Cross Compile for AWS AMI]
  cgoCompile[CGO Docker Compile for AWS AMI]
  postBuild[WorkflowHook - PostBuild]
  style postBuild fill:#61B6EB,stroke:#000,stroke-width:4px;

  nodeJSProxyShims[Create NodeJS-Go HTTP Proxies]
  pythonJSProxyShims[Create Python-CGO HTTP Proxies]
  package[ZIP archive]
  userArchive[WorkflowHook - Archive]
  style userArchive fill:#61B6EB,stroke:#000,stroke-width:4px;

  upload[Upload Archive to S3]
  packageAssets[Conditionally ZIP S3 Site Assets]
  uploadAssets[Upload S3 Assets]
  preMarshall[WorkflowHook - PreMarshall]
  style preMarshall fill:#61B6EB,stroke:#000,stroke-width:4px;

  generate[Marshal to CloudFormation]
  decorate[Call Lambda Decorators - Dynamic AWS Resources]

  serviceDecorator[Service Decorator]
  style serviceDecorator fill:#61B6EB,stroke:#000,stroke-width:4px;

  postMarshall[WorkflowHook - PostMarshall]
  style postMarshall fill:#61B6EB,stroke:#000,stroke-width:4px;

  uploadTemplate[Upload Template to S3]
  updateStack[Create/Update Stack]
  inplaceUpdates[In-place Î» code updates]
  wait[Wait for Complete/Failure Result]

  iam-->preBuild
  preBuild-->|go|compile
  preBuild-->|cgo|cgoCompile
  compile-->postBuild
  cgoCompile-->postBuild
  postBuild-->|go|nodeJSProxyShims

  nodeJSProxyShims-->package
  nodeJSProxyShims-->packageAssets

  postBuild-->|cgo|pythonJSProxyShims
  pythonJSProxyShims-->package
  pythonJSProxyShims-->packageAssets

  package-->userArchive
  userArchive-->upload
  packageAssets-->uploadAssets
  uploadAssets-->generate
  upload-->generate

  generate-->preMarshall
  preMarshall-->decorate
  decorate-->serviceDecorator
  serviceDecorator-->postMarshall
  postMarshall-->uploadTemplate
  uploadTemplate-->|standard|updateStack
  uploadTemplate-->|inplace|inplaceUpdates
  updateStack-->wait
</div>
<h6>This diagram is rendered with <a href="https://github.com/knsv/mermaid" target="_blank">Mermaid</a>. Please open an <a href="https://github.com/mweagle/Sparta/issues/new" target="_blank">issue</a> if it doesn't render properly.</h6>
<hr />
